(this.webpackJsonpwhatsapp=this.webpackJsonpwhatsapp||[]).push([[0],{104:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){"use strict";a.r(t);var c=a(4),s=a(2),n=a.n(s),i=a(27),r=a.n(i),o=(a(75),a(12)),j=(a(76),a(77),a(58)),d=a.n(j),l=a(59),b=a.n(l),u=a(60),h=a.n(u),O=a(125),m=a(119),p=a(120),x=(a(78),a(29)),f=x.a.initializeApp({apiKey:"AIzaSyAR8qaU_YaUNQt5rPduUVYh26B2uylLpqs",authDomain:"whatsapp-clone-by-jayanth.firebaseapp.com",databaseURL:"https://whatsapp-clone-by-jayanth.firebaseio.com",projectId:"whatsapp-clone-by-jayanth",storageBucket:"whatsapp-clone-by-jayanth.appspot.com",messagingSenderId:"251280842316",appId:"1:251280842316:web:4835bb9c8549ffe79bdee9",measurementId:"G-DBZCMHJQB4"}).firestore(),v=x.a.auth(),g=new x.a.auth.GoogleAuthProvider,N=f,S=a(31);var y=function(e){var t,a=Object(s.useState)(""),n=Object(o.a)(a,2),i=n[0],r=n[1],j=Object(s.useState)([]),d=Object(o.a)(j,2),l=d[0],b=d[1];return Object(s.useEffect)((function(){e.id&&N.collection("rooms").doc(e.id).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return b(e.docs.map((function(e){return e.data()})))}))})),Object(s.useEffect)((function(){r(Math.floor(5e3*Math.random()))}),[e.id]),e.addNewChat?Object(c.jsx)("div",{onClick:function(){var e=prompt("Please enter room name");e&&N.collection("rooms").add({name:e})},className:"sidebarChat",children:Object(c.jsx)("h2",{className:"addnewchat",children:" Add New Chat"})}):Object(c.jsx)(S.b,{to:"/rooms/".concat(e.id),children:Object(c.jsxs)("div",{className:"sidebarChat",children:[Object(c.jsx)(O.a,{src:"https://avatars.dicebear.com/api/human/".concat(i,".svg")}),Object(c.jsxs)("div",{className:"info",children:[Object(c.jsx)("h2",{children:e.name}),Object(c.jsx)("p",{children:null===(t=l[0])||void 0===t?void 0:t.message})]})]})})},w=Object(s.createContext)(),C=function(e){var t=e.reducer,a=e.initialState,n=e.children;return Object(c.jsx)(w.Provider,{value:Object(s.useReducer)(t,a),children:n})},E=function(){return Object(s.useContext)(w)};var I=function(){var e=E(),t=Object(o.a)(e,2),a=t[0].user,n=(t[1],Object(s.useState)([])),i=Object(o.a)(n,2),r=i[0],j=i[1],l=Object(s.useState)(""),u=Object(o.a)(l,2),x=(u[0],u[1]);return Object(s.useEffect)((function(){x(Math.floor(5e3*Math.random()))}),[]),Object(s.useEffect)((function(){var e=N.collection("rooms").onSnapshot((function(e){return j(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]),Object(c.jsxs)("div",{className:"sidebar",children:[Object(c.jsxs)("div",{className:"header",children:[Object(c.jsx)(O.a,{src:null===a||void 0===a?void 0:a.photoURL}),Object(c.jsxs)("div",{className:"right",children:[Object(c.jsx)(m.a,{children:Object(c.jsx)(d.a,{})}),Object(c.jsx)(m.a,{children:Object(c.jsx)(b.a,{})}),Object(c.jsx)(m.a,{children:Object(c.jsx)(h.a,{})})]})]}),Object(c.jsx)("div",{className:"search",children:Object(c.jsxs)("div",{className:"searchContainer",children:[Object(c.jsx)(p.a,{}),Object(c.jsx)("input",{placeholder:"Search or Start a New Chat"})]})}),Object(c.jsxs)("div",{className:"chats",children:[Object(c.jsx)(y,{addNewChat:1}),r.map((function(e){return Object(c.jsx)(y,{id:e.id,name:e.data.name},e.id)}))]})]})},U=a(121),k=a(122),M=a(123),_=a(62),A=a.n(_),B=a(61),D=a.n(B).a.create({baseURL:"http://localhost:9000"}),R=(a(104),a(9)),L=a(63),P=a.n(L);var T=function(){var e,t,a=Object(s.useState)(""),n=Object(o.a)(a,2),i=n[0],r=n[1],j=Object(s.useState)(""),d=Object(o.a)(j,2),l=d[0],b=d[1],u=Object(R.f)("").roomId,h=Object(s.useState)(""),p=Object(o.a)(h,2),f=p[0],v=p[1],g=Object(s.useState)([]),S=Object(o.a)(g,2),y=S[0],w=S[1],C=E(),I=Object(o.a)(C,2),_=I[0].user;return I[1],Object(s.useEffect)((function(){u&&(N.collection("rooms").doc(u).onSnapshot((function(e){return v(e.data().name)})),N.collection("rooms").doc(u).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){return w(e.docs.map((function(e){return e.data()})))})))}),[u]),Object(s.useEffect)((function(){b(Math.floor(5e3*Math.random()))}),[u]),Object(c.jsxs)("div",{className:"chat",children:[Object(c.jsxs)("div",{className:"header",children:[Object(c.jsx)(O.a,{className:"avatar",src:"https://avatars.dicebear.com/api/human/".concat(l,".svg")}),Object(c.jsxs)("div",{className:"header_info",children:[Object(c.jsx)("h3",{children:f}),Object(c.jsxs)("p",{children:["Last seen at ",new Date(null===(e=y[y.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()]})]}),Object(c.jsxs)("div",{className:"right",children:[Object(c.jsx)(m.a,{children:Object(c.jsx)(A.a,{})}),Object(c.jsx)(m.a,{children:Object(c.jsx)(U.a,{})}),Object(c.jsx)(m.a,{children:Object(c.jsx)(k.a,{})})]})]}),Object(c.jsx)("div",{className:"body",children:y.map((function(e){var t;return Object(c.jsxs)("p",{className:"message ".concat(e.name==_.displayName&&"receive"," "),children:[Object(c.jsx)("span",{className:"name",children:e.name}),e.message,Object(c.jsx)("span",{className:"timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))}),Object(c.jsxs)("div",{className:"footer",children:[Object(c.jsx)(m.a,{children:Object(c.jsx)(M.a,{})}),Object(c.jsxs)("form",{children:[Object(c.jsx)("input",{value:i,onChange:function(e){return r(e.target.value)},placeholder:"Type a message",type:"text"}),Object(c.jsx)("button",{onClick:function(e){e.preventDefault(),N.collection("rooms").doc(u).collection("messages").add({message:i,name:_.displayName,timestamp:x.a.firestore.FieldValue.serverTimestamp()}),r("")},type:"submit",children:"Send a message"})]}),Object(c.jsx)(m.a,{children:Object(c.jsx)(P.a,{})})]})]})},W=(a(105),a(64)),G=a(124),J=(a(106),a(45)),q="SET_USER",z=function(e,t){switch(console.log(t),t.type){case q:return Object(J.a)(Object(J.a)({},e),{},{user:t.user});default:return e}};var Q=function(){var e=E(),t=Object(o.a)(e,2);Object(W.a)(t[0]);var a=t[1];return Object(c.jsx)("div",{className:"login",children:Object(c.jsxs)("div",{className:"login__container",children:[Object(c.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg",alt:""}),Object(c.jsx)("div",{className:"login__text",children:Object(c.jsx)("h1",{children:"Sign in to WhatsApp"})}),Object(c.jsx)(G.a,{onClick:function(){v.signInWithPopup(g).then((function(e){a({type:q,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign in With Google"})]})})};var V=function(){var e=E(),t=Object(o.a)(e,2),a=t[0].user,n=(t[1],Object(s.useState)([])),i=Object(o.a)(n,2),r=(i[0],i[1]);return Object(s.useEffect)((function(){D.get("/messages/sync").then((function(e){r(e.data)}))}),[]),Object(c.jsx)("div",{className:"app",children:a?Object(c.jsx)("div",{className:"app_body",children:Object(c.jsxs)(S.a,{children:[Object(c.jsx)(I,{}),Object(c.jsx)(R.c,{children:Object(c.jsx)(R.a,{path:"/rooms/:roomId",children:Object(c.jsx)(T,{})})})]})}):Object(c.jsx)(Q,{})})};r.a.render(Object(c.jsx)(n.a.StrictMode,{children:Object(c.jsx)(C,{initialState:{user:null},reducer:z,children:Object(c.jsx)(V,{})})}),document.getElementById("root"))},75:function(e,t,a){},76:function(e,t,a){},77:function(e,t,a){},78:function(e,t,a){}},[[107,1,2]]]);
//# sourceMappingURL=main.665bd750.chunk.js.map